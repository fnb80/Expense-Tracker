RESET = "\033[0m"
RED = "\033[91m"
GREEN = "\033[92m"
YELLOW = "\033[93m"
CYAN = "\033[96m"
BOLD = "\033[1m"

# Dictionary to store all expenses by category
expenses = {
  "food": [],
  "transport": [],
  "entertainment": []
}

def add_expense():
  # Ask the user to choose a category
  category = input(CYAN + "Enter category (food / transport / entertainment): " + RESET).lower()

  # Check if the category exists in the dictionary
  if category not in expenses:
    print(RED + "Invalid category. Expense not added." + RESET)
    return

  # Ask the user to enter the expense amount
  # Use try-except to prevent crashes if the input is not a number
  try:
    amount = float(input(CYAN + "Enter amount: " + RESET))
  except ValueError:
    print(RED + "Invalid amount. Please enter a number." + RESET)
    return

  # Ask the user to enter the date of the expense
  date = input(CYAN + "Enter date (YYYY-MM-DD): " + RESET)

  # Create a dictionary to represent one expense
  expense = {
    "amount": amount,
    "date": date
  }

  # Add the expense to the correct category list
  expenses[category].append(expense)

  # Confirm that the expense was added successfully
  print(GREEN + "Expense added successfully!" + RESET)
  
def view_expenses():
  # Check if there are any expenses stored
  # If all categories are empty, show a message
    if not expenses["food"] and not expenses["transport"] and not expenses["entertainment"]:
        print(YELLOW + "No expenses have been added yet." + RESET)
        return

  # Loop through each category and its expense list
    for category, expense_list in expenses.items():
      print(BOLD + CYAN + f"\nCategory: {category.capitalize()}" + RESET)

    # If the category has no expenses, let the user know
      if not expense_list:
        print("  No expenses in this category.")
      else:
      # Loop through each expense in the list
        for expense in expense_list:
        # Display each expense with amount and date
          print(f"  - ${expense['amount']:.2f} on {expense['date']}")

def calculating_total_expenses():

  #ask user which category they want to calculate, or the total
  user_input = input("please enter [food], [transport], [entertainment], or [total] to calculate: ").lower()

  #check if category is in expenses, if so, calculate total
  if user_input in expenses:
    expense_total = sum(expense["amount"] for expense in expenses[user_input])
    print("---------------- ")
    print(BOLD + f"Total for {user_input}: ${expense_total:.2f}" + RESET)
    print("---------------- ")

  #if user wants the calculate the total of everything, calculate
  elif user_input == 'total':
   total_total = sum(sum(expense['amount'] for expense in expenses[category]) for category in expenses)
   print("---------------- ")
   print(BOLD + f"Total Expenses: ${total_total:.2f}" + RESET)
   print("---------------- ")

#user error prevention in case they do not input a valid category
  else:
   print(RED + "Please input a valid category!" + RESET)
   return
        
                 
def deleting_expenses():
    #ask user which category they would like to delete from 
    category = input("Enter [food / transport / entertainment]: ").lower()

    #check if the category is in the expense, if not, return
    if category not in expenses: 
      print(RED + "Please enter a valid category!" + RESET)
      return

    #check if there are any expenses in the category, if not, return
    if not expenses[category]:
      print(RED + "There are no expenses in this category!" + RESET)
      return

    #label each expense with a number starting from 1 for easy organization
    for i, expense in enumerate(expenses[category], start =1):
            print(f"{i}. ${expense['amount']:.2f} on {expense['date']}")

    #ask user to input the expense # to delete
    try:
      choice = int(input("Enter expense # to delete: "))
      removed = expenses[category].pop(choice-1)
      print(GREEN + "Expense Removed!" + RESET)

    #if user does not enter a valid expense, return 
    except (ValueError, IndexError):
      print(RED + "Please enter a valid expense!" + RESET)
      return

def main_menu():

  #print main menu with options
  print(YELLOW+"Welcome to the Expense Tracker!"+RESET)
  print ("")
  print ("[1] Add expense ")
  print ("[2] View All Expenses ")
  print ("[3] Delete an Expense ")
  print ("[4] Enter Calculator Mode")
  print("[q] Quit")


# Show menu
while True:
  main_menu()

# Get user choice
  choice = input(CYAN + "Select an option (1-4 or q): " + RESET)

  if choice == "1":
    add_expense()

  elif choice == "2":
    view_expenses()

  elif choice == "3":
    deleting_expenses ()

  elif choice == "4":
    calculating_total_expenses()

  elif choice.lower() == "q":
    print(GREEN + "Goodbye!" + RESET)
    break
    
  else:
    print(RED + "Invalid option. Please choose 1-4 or q." + RESET)
           
          
                 









